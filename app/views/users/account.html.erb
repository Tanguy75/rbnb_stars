<div class="row">
  <!-- encart photo et infos -->
  <div class="col-lg-4 ">
    <div class="user">
      <div class="user-infos flex-column justify-content-center align-items-start mt-5 p-5">
        <ul class="rounded bg-light shadow-sm py-5">
          <h3 class="text-justify">Username</h3>
          <li class="my-3"><%= @user.username %></li>
          <h3 class="text-justify">First Name</h3>
          <li class="my-3"><%= @user.first_name %></li>
          <h3 class="text-justify">Last Name</h3>
          <li class="my-3"><%= @user.last_name %></li>
          <h3 class="text-justify">Email</h3>
          <li class="my-3"><%= @user.email %></li>
          <h3 class="text-justify">Member since</h3>
          <li class="my-3"><%= @user.created_at %></li>
          <li class="text-right">
            <%= link_to edit_user_registration_path, class: "text-gray edition" do %>
              <i class="fas fa-pen-square"></i>
            <% end %>
          </li>
        </ul>
      </div>
        <% if @user.photo.attached? %>
          <%= image_tag @user.photo, alt: "alttext", class: "big-avatar img-profile" %>
        <% else %>
          <%= image_tag "brad.jpg", alt: "alttext", class: "big-avatar img-profile" %>
        <% end %>
      </div>
  </div>
  <!-- encart your bookings -->
  <div class="col-lg-8 mt-5 py-5">
    <div class="bg-light rounded mr-5 p-5 shadow-sm bookings">
      <!-- upcoming -->
      <h1>Your upcoming bookings</h1>
      <% @user.bookings.each do |booking| %>
        <% if booking.start_date > Time.now %>
          <div class="booking rouded border mt-1 rounded shadow-sm profile-part-info d-flex justify-content-between align-items-center">
            <div class="profile-part-info-left d-flex justify-content-start align-items-center">
              <%= image_tag booking.star_part.photo, alt: "alttext" %>
              <div class="profil-part-info-text">
                <h2><%= booking.star_part.name_of_star %>'s <%= booking.star_part.name_of_part %></h2>
                <h3>From <%= booking.start_date %> - To <%= booking.end_date %></h3>
              </div>
            </div>
            <%= link_to star_part_booking_path(booking.star_part.id, booking.id), method: :delete, data: { confirm: 'Are you sure?' } do  %>
              <i class="fas fa-trash text-gray mr-3"></i>
            <% end %>

          </div>
        <% end %>
      <% end %>
      <!-- passed -->
      <h1>Your 3 latest bookings</h1>
      <% @user.bookings[0..3].each do |booking| %>
        <% if booking.start_date < Time.now %>
          <div class="booking rouded border mt-1 rounded shadow-sm profile-part-info d-flex justify-content-between align-items-center">
            <div class="profile-part-info-left d-flex justify-content-start align-items-center">
              <%= image_tag booking.star_part.photo, alt: "alttext" %>
              <div class="profil-part-info-text">
                <h2><%= booking.star_part.name_of_star %>'s <%= booking.star_part.name_of_part %></h2>
                <h3>From <%= booking.start_date %> - To <%= booking.end_date %></h3>
                <button type="button" class="link-rose" data-toggle="modal" data-target="#exampleModal">
                Book Again
              </button>
              </div>
            </div>

            <%= link_to "leave a review", "#", class: "bg-rose mr-3"  %>

            <!-- Modal -->

            <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
              <div class="modal-dialog" role="document">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Book</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body">
                        <%= simple_form_for [booking.star_part, Booking.new] do |f| %>
                        <%= f.input :start_date, as: :string, required: true, input_html: {class: "datepicker"} %>
                        <%= f.input :end_date, as: :string, required: true, input_html: {class: "datepicker"} %>
                        <%= f.input :price, as: :string, disabled: true, input_html: {value: booking.star_part.price} %>
                        <%= f.submit "Book", class: "btn btn-success"%>
                        <% end %>

                        <% booking.star_part.unavailable_dates.each do |date|%>
                          <div class="unavailable-dates" data-unavailable=<%= date %>></div>
                        <% end %>

                  </div>
                </div>
              </div>
            </div>

            <!-- end of modal -->

          </div>
        <% end %>
      <% end %>
    </div>
  </div>
</div>

<div class="card-container mt-3" >
  <div class="d-flex justify-content-end ">
  </div>
  <div class="cards">
    <% @user.star_parts.each do |part| %>
        <div class="card-trip rounded">
          <%= cl_image_tag part.photo.key, class: "part-img" %>
          <div class="card-trip-infos">
            <div class="text-justify">
              <small>
                <% part.rating.times do %>
                    <i class="fa fa-star text-rose"></i>
                <% end %>
                <% (5 - part.rating).times do %>
                    <i class="far fa-star text-rose"></i>
                <% end %>
              </small>
              <h5><%= part.name_of_star %>'s <%= part.name_of_part.capitalize() %></h5>
            </div>
          <h2 class="card-trip-pricing"> â‚¬ <%= part.price  %> </h2>
          <%= cl_image_tag(part.user.photo.key, class: "card-trip-user avatar-bordered") %>
          </div>
          <div class="d-flex justify-content-between py-1 px-3">
            <%= link_to edit_star_part_path(part), class: "text-gray" do %>
              <i class="fas fa-pen-square"></i>
            <% end %>
            <%= link_to star_part_path(part), method: :delete, data: { confirm: 'Are you sure?' }, class: "text-gray ml-2" do %>
              <i class="fas fa-trash"></i>
            <% end %>

          </div>
        </div>
      <% end %>
  </div>
</div>



